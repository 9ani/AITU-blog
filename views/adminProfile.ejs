<!DOCTYPE html>
<html lang="en">
<head>
    <%- include('./partials/head.ejs') %>
    <title>Admin Profile</title>
</head>
<body>
    <%- include('./partials/header.ejs', { user: loginUser }) %>

    <div class="container"> 
        <h2>Welcome, <%= loginUser.full_name %> (Admin)</h2>

        <h3>All Users</h3>
        <ul>
            <% users.forEach(user => { %>
                <li>
                    <%= user.full_name %> - <%= user.email %>
                    <!-- Add Edit and Delete buttons with corresponding form actions -->
                    <form method="POST" action="/admin/edit/<%= user._id %>">
                        <button type="submit">Edit</button>
                    </form>
                    <form method="POST" action="/admin/delete/<%= user._id %>" id="deleteForm">
                      <input type="hidden" name="_method" value="DELETE">
                      <button type="button" onclick="deleteUser('<%= user._id %>')">Delete</button>
                  </form>
                  
                </li>
            <% }) %>
        </ul>

        <!-- Add form for adding a new user -->
<h2 class="mt-4">Add User</h2>
            <form id="addForm">
              <div class="form-group">
                <label for="addUsername">Username:</label>
                <input type="text" class="form-control" id="addUsername" name="username" required>
              </div>
              <div class="form-group">
                <label for="addPassword">Password:</label>
                <input type="password" class="form-control" id="addPassword" name="password" required>
              </div>
              <div class="form-group form-check">
                <input type="checkbox" class="form-check-input" id="isAdmin" name="isAdmin">
                <label class="form-check-label" for="isAdmin">Admin</label>
              </div>
              <button type="button" class="btn btn-success" onclick="addUser()">Add User</button>
            </form>
            
            <h2 class="mt-4">Edit User</h2>
            <form id="editForm">
            </form>

    </div>
    <script>
      function deleteUser(userId) {
          if (confirm("Are you sure you want to delete this user?")) {
              const form = document.getElementById('deleteForm');
              form.action = `/admin/delete/${userId}`;
              form.submit();
          }
      }
  </script>
</body>
</html>
